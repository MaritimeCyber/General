<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     Ship Order Trends Widget ‚Äî shippauljobs.blogspot.com
     Í∏∞Îä•: Í∏ÄÎ°úÎ≤å Ïã†Ï°∞ÏÑ† Î∞úÏ£º Îâ¥Ïä§ Ïã§ÏãúÍ∞Ñ ÌëúÏãú (ÌÖåÏù¥Î∏î, ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò)
     Ï∂úÏ≤ò: Splash247 ¬∑ Hellenic Shipping News
     ÏÇ¨Ïö©: Blogger ‚Üí Î†àÏù¥ÏïÑÏõÉ ‚Üí HTML/ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏ Í∞ÄÏ†ØÏóê Î∂ôÏó¨ÎÑ£Í∏∞
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700;900&display=swap" rel="stylesheet"/>

<style>
  #sot-wrap,#sot-wrap *{box-sizing:border-box;font-family:"Roboto",Arial,sans-serif;margin:0;padding:0;}
  @keyframes sot-pulse{0%,100%{opacity:1}50%{opacity:0.35}}
  #sot-header{display:flex;align-items:baseline;justify-content:space-between;margin-bottom:12px;}
  #sot-header-title{font-size:17px;font-weight:900;color:#424242;line-height:1.2;}
  #sot-refresh-btn{display:inline-block;background:#1a9e82;color:#fff;font-size:11.5px;font-weight:700;
    padding:2px 10px;border-radius:20px;letter-spacing:0.3px;vertical-align:middle;border:none;cursor:pointer;transition:opacity 0.2s;}
  #sot-refresh-btn:hover:not(:disabled){opacity:0.82;}
  #sot-refresh-btn:disabled{opacity:0.5;cursor:not-allowed;}
  #sot-divider{display:flex;align-items:center;gap:10px;margin-bottom:14px;}
  .sot-divider-line{flex:1;height:1px;background:#e0e0e0;}
  .sot-divider-dot{width:6px;height:6px;border-radius:50%;background:#1a9e82;flex-shrink:0;}
  #sot-tabs{display:flex;overflow-x:auto;border-bottom:1px solid #e0e0e0;background:#f4faf8;
    padding:0 6px;scrollbar-width:none;margin-bottom:12px;}
  #sot-tabs::-webkit-scrollbar{display:none;}
  .sot-tab{flex:0 0 16.6%;background:none;border:none;border-bottom:2px solid transparent;
    color:#9fb5c2;font-size:13px;font-weight:600;padding:8px 6px;cursor:pointer;
    white-space:nowrap;text-align:center;transition:color 0.15s,border-color 0.15s;}
  .sot-tab:hover{color:#1a9e82;}
  .sot-tab.active{color:#1a9e82;border-bottom-color:#1a9e82;}
  #sot-loading{text-align:center;padding:22px 10px;color:#6b8599;font-size:12.5px;
    letter-spacing:0.3px;animation:sot-pulse 1.6s ease-in-out infinite;}
  #sot-list{display:none;}
  #sot-table-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch;}
  #sot-table{width:100%;border-collapse:collapse;min-width:480px;}
  #sot-table th{font-size:10px;font-weight:700;color:#b0c4ce;letter-spacing:1px;text-transform:uppercase;
    padding:5px 8px;border-bottom:1px solid #e0e0e0;text-align:left;white-space:nowrap;}
  #sot-table td{padding:9px 8px;border-bottom:1px solid #f0f5f8;vertical-align:middle;line-height:1.5;}
  #sot-table tr:last-child td{border-bottom:none;}
  #sot-table tr:hover td{background:#f9fcfb;}
  .sot-td-date{white-space:nowrap;font-size:11px;color:#9fb5c2;}
  .sot-src{display:inline-block;background:#e8f6f3;color:#1a9e82;font-size:10px;font-weight:700;
    padding:1px 6px;border-radius:10px;letter-spacing:0.2px;white-space:nowrap;}
  .sot-type-tag{display:inline-block;background:#f4faf8;color:#5a7080;font-size:10px;font-weight:700;
    padding:1px 6px;border-radius:10px;white-space:nowrap;}
  .sot-td-none{font-size:11px;color:#c8d8e0;}
  .sot-table-title{font-size:12.5px;font-weight:700;color:#424242;text-decoration:none;line-height:1.5;}
  .sot-table-title:hover{color:#1a9e82;text-decoration:underline;}
  #sot-pagination{display:flex;align-items:center;justify-content:space-between;margin-top:12px;}
  .sot-page-btn{display:inline-block;background:#1a9e82;color:#fff;font-size:11px;font-weight:700;
    padding:2px 10px;border-radius:20px;letter-spacing:0.3px;border:none;cursor:pointer;transition:opacity 0.2s;}
  .sot-page-btn:hover:not(:disabled){opacity:0.82;}
  .sot-page-btn:disabled{background:#e8f6f3;color:#9fb5c2;cursor:not-allowed;}
  #sot-page-info{font-size:11.5px;color:#9fb5c2;text-align:center;}
  #sot-status{margin-top:10px;padding:8px 10px;background:#f9fafa;border-radius:4px;
    font-size:10.5px;color:#9fb5c2;line-height:1.7;white-space:pre-wrap;display:none;}
  #sot-empty{display:none;padding:22px 0;font-size:13px;color:#9fb5c2;text-align:center;line-height:1.9;}
  #sot-footer{margin-top:13px;padding:9px 12px;background:#f4faf8;border-left:3px solid #1a9e82;
    border-radius:4px;font-size:12px;color:#5a7080;line-height:1.7;
    display:flex;justify-content:space-between;align-items:center;}
</style>

<div id="sot-wrap">
  <div id="sot-header">
    <span id="sot-header-title">üö¢ Ship Order Trends</span>
    <button id="sot-refresh-btn">‚ü≥ Refresh</button>
  </div>
  <div id="sot-divider">
    <div class="sot-divider-line"></div>
    <div class="sot-divider-dot"></div>
    <div class="sot-divider-line"></div>
  </div>
  <div id="sot-tabs">
    <button class="sot-tab active" data-key="all">All</button>
    <button class="sot-tab" data-key="tanker">Tanker</button>
    <button class="sot-tab" data-key="container">Container</button>
    <button class="sot-tab" data-key="lng">LNG / Gas</button>
    <button class="sot-tab" data-key="bulk">Bulk</button>
    <button class="sot-tab" data-key="car">Car Carrier</button>
  </div>
  <div id="sot-loading">üì° Fetching latest maritime news‚Ä¶</div>
  <div id="sot-list">
    <div id="sot-table-wrap">
      <table id="sot-table">
        <thead>
          <tr>
            <th>Date</th><th>Source</th><th>Type</th><th>Title</th>
          </tr>
        </thead>
        <tbody id="sot-tbody"></tbody>
      </table>
    </div>
    <div id="sot-status"></div>
    <div id="sot-pagination">
      <button class="sot-page-btn" id="sot-prev-btn">‚óÄ Prev</button>
      <span id="sot-page-info">‚Äî</span>
      <button class="sot-page-btn" id="sot-next-btn">Next ‚ñ∂</button>
    </div>
    <div id="sot-empty"></div>
  </div>
  <div id="sot-footer">
    <span>Splash247 ¬∑ Hellenic Shipping News</span>
    <span id="sot-updated">‚Äî</span>
  </div>
</div>

<script>
(function () {
  "use strict";

  var ITEMS_PER_PAGE = 20;
  var currentPage = 1;
  var filteredItems = [];
  var allItems = [];
  var activeTab = "all";
  var feedLog = [];
  var pendingFeeds = 0;

  var FEEDS = [
    { url: "https://splash247.com/feed/", name: "Splash247" },
    { url: "https://www.hellenicshippingnews.com/feed/", name: "HSN" }
  ];

  var CAT_KW = {
    all: [],
    tanker: ["tanker","vlcc","suezmax","aframax","product tanker","crude","chemical tanker","mr tanker"],
    container: ["container","teu","boxship","containership","feeder","ultra large"],
    lng: ["lng","lpg","fsru","flng","gas carrier","liquefied","ammonia","methanol"],
    bulk: ["bulker","bulk carrier","capesize","panamax","handysize","handymax","ultramax","kamsarmax"],
    car: ["pctc","car carrier","roro","ro-ro","vehicle carrier","pcctc","pure car"]
  };

  /* ‚îÄ‚îÄ JSONP via script-tag injection (no CORS restriction) ‚îÄ‚îÄ */
  function fetchViaJSONP(feed, onDone) {
    var cbName = "sotCb_" + Date.now() + "_" + Math.floor(Math.random() * 99999);
    var scriptEl = null;

    var timer = setTimeout(function () {
      cleanup();
      feedLog.push(feed.name + ": JSONP ‚úó timeout");
      onDone([]);
    }, 14000);

    function cleanup() {
      clearTimeout(timer);
      window[cbName] = null;
      if (scriptEl && scriptEl.parentNode) scriptEl.parentNode.removeChild(scriptEl);
    }

    window[cbName] = function (data) {
      cleanup();
      if (!data || data.status !== "ok" || !data.items) {
        feedLog.push(feed.name + ": JSONP ‚úó status=" + (data ? data.status : "null"));
        onDone([]);
        return;
      }
      var items = data.items.map(function (i) {
        return {
          title: (i.title || "").replace(/<[^>]+>/g, "").trim(),
          link: i.link || i.guid || "",
          pubDate: i.pubDate || "",
          description: (i.description || "").replace(/<[^>]+>/g, "").slice(0, 200),
          _src: feed.name
        };
      });
      feedLog.push(feed.name + ": JSONP ‚úì (" + items.length + ")");
      onDone(items);
    };

    scriptEl = document.createElement("script");
    scriptEl.onerror = function () {
      cleanup();
      feedLog.push(feed.name + ": JSONP ‚úó load-error");
      onDone([]);
    };
    scriptEl.src = "https://api.rss2json.com/v1/api.json?count=50&rss_url=" +
      encodeURIComponent(feed.url) + "&callback=" + cbName;
    document.head.appendChild(scriptEl);
  }

  /* ‚îÄ‚îÄ fetch fallback (rss2json without JSONP) ‚îÄ‚îÄ */
  function fetchViaHttp(feed, onDone) {
    var url = "https://api.rss2json.com/v1/api.json?count=50&rss_url=" + encodeURIComponent(feed.url);
    fetch(url, { cache: "no-store" })
      .then(function (r) { return r.json(); })
      .then(function (d) {
        if (!d || d.status !== "ok" || !d.items) {
          feedLog.push(feed.name + ": fetch ‚úó status=" + (d ? d.status : "null"));
          onDone([]);
          return;
        }
        var items = d.items.map(function (i) {
          return {
            title: (i.title || "").replace(/<[^>]+>/g, "").trim(),
            link: i.link || i.guid || "",
            pubDate: i.pubDate || "",
            description: (i.description || "").replace(/<[^>]+>/g, "").slice(0, 200),
            _src: feed.name
          };
        });
        feedLog.push(feed.name + ": fetch ‚úì (" + items.length + ")");
        onDone(items);
      })
      .catch(function (e) {
        feedLog.push(feed.name + ": fetch ‚úó " + e.message);
        onDone([]);
      });
  }

  /* ‚îÄ‚îÄ allorigins fallback ‚îÄ‚îÄ */
  function parseRSSXML(xmlStr, srcName) {
    try {
      var parser = new DOMParser();
      var doc = parser.parseFromString(xmlStr, "text/xml");
      if (doc.getElementsByTagName("parsererror").length) return [];
      var nodes = doc.getElementsByTagName("item");
      var result = [];
      for (var i = 0; i < Math.min(nodes.length, 50); i++) {
        var node = nodes[i];
        var title = (node.getElementsByTagName("title")[0] || {}).textContent || "";
        if (!title.trim()) continue;
        var linkEl = node.getElementsByTagName("link")[0];
        var link = linkEl ? (linkEl.textContent.trim() || linkEl.getAttribute("href") || "") : "";
        var pubDate = (node.getElementsByTagName("pubDate")[0] || {}).textContent || "";
        result.push({ title: title.trim(), link: link, pubDate: pubDate, description: "", _src: srcName });
      }
      return result;
    } catch (e) { return []; }
  }

  function fetchViaAllOrigins(feed, onDone) {
    var url = "https://api.allorigins.win/get?url=" + encodeURIComponent(feed.url);
    fetch(url, { cache: "no-store" })
      .then(function (r) { return r.json(); })
      .then(function (d) {
        if (!d || !d.contents) { feedLog.push(feed.name + ": allorigins ‚úó no-content"); onDone([]); return; }
        var items = parseRSSXML(d.contents, feed.name);
        feedLog.push(feed.name + ": allorigins " + (items.length ? "‚úì (" + items.length + ")" : "‚úó 0 items"));
        onDone(items);
      })
      .catch(function (e) { feedLog.push(feed.name + ": allorigins ‚úó " + e.message); onDone([]); });
  }

  /* ‚îÄ‚îÄ fetch one feed: JSONP first, then http, then allorigins ‚îÄ‚îÄ */
  function fetchFeed(feed, allDone) {
    fetchViaJSONP(feed, function (items) {
      if (items.length) { allDone(items); return; }
      fetchViaHttp(feed, function (items2) {
        if (items2.length) { allDone(items2); return; }
        fetchViaAllOrigins(feed, allDone);
      });
    });
  }

  /* ‚îÄ‚îÄ filter & type detect ‚îÄ‚îÄ */
  function matchesCat(item, cat) {
    if (cat === "all") return true;
    var txt = ((item.title || "") + " " + (item.description || "")).toLowerCase();
    return CAT_KW[cat].some(function (k) { return txt.indexOf(k) !== -1; });
  }

  function detectType(item) {
    var txt = ((item.title || "") + " " + (item.description || "")).toLowerCase();
    var order = ["car","lng","tanker","container","bulk"];
    var labels = { car: "Car Carrier", lng: "LNG/Gas", tanker: "Tanker", container: "Container", bulk: "Bulk" };
    for (var i = 0; i < order.length; i++) {
      if (CAT_KW[order[i]].some(function (k) { return txt.indexOf(k) !== -1; })) return labels[order[i]];
    }
    return null;
  }

  function fmtDate(ds) {
    var d = new Date(ds);
    if (isNaN(d.getTime())) return "‚Äî";
    return d.toLocaleDateString("en-GB", { day: "2-digit", month: "short", year: "numeric" });
  }

  function escAttr(s) { return (s || "").replace(/"/g, "&quot;").replace(/</g, "&lt;"); }
  function escHTML(s) { return (s || "").replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;"); }

  /* ‚îÄ‚îÄ render ‚îÄ‚îÄ */
  function renderPage() {
    var tbody = document.getElementById("sot-tbody");
    var pageInfo = document.getElementById("sot-page-info");
    var prevBtn = document.getElementById("sot-prev-btn");
    var nextBtn = document.getElementById("sot-next-btn");
    var tableWrap = document.getElementById("sot-table-wrap");
    var pagination = document.getElementById("sot-pagination");
    var emptyEl = document.getElementById("sot-empty");
    var statusEl = document.getElementById("sot-status");

    if (feedLog.length) {
      statusEl.textContent = "üìã " + feedLog.join("  ¬∑  ");
      statusEl.style.display = "block";
    } else {
      statusEl.style.display = "none";
    }

    if (!filteredItems.length) {
      tableWrap.style.display = "none";
      pagination.style.display = "none";
      emptyEl.style.display = "block";
      emptyEl.innerHTML = allItems.length === 0
        ? "‚ö†Ô∏è Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§ÏßÄ Î™ªÌñàÏäµÎãàÎã§.<br><span style='font-size:11px'>ÏúÑ ÏßÑÎã® Î°úÍ∑∏Î•º ÌôïÏù∏Ìï¥ Ï£ºÏÑ∏Ïöî.</span>"
        : "Ïù¥ Ïπ¥ÌÖåÍ≥†Î¶¨Ïóê Ìï¥ÎãπÌïòÎäî Îâ¥Ïä§Í∞Ä ÏóÜÏäµÎãàÎã§.<br><span style='font-size:11px'>All ÌÉ≠ÏùÑ ÏÑ†ÌÉùÌïòÍ±∞ÎÇò RefreshÎ•º ÎàåÎü¨ Ï£ºÏÑ∏Ïöî.</span>";
      return;
    }

    tableWrap.style.display = "block";
    emptyEl.style.display = "none";

    var total = filteredItems.length;
    var totalPages = Math.ceil(total / ITEMS_PER_PAGE);
    var start = (currentPage - 1) * ITEMS_PER_PAGE;
    var end = Math.min(start + ITEMS_PER_PAGE, total);

    tbody.innerHTML = filteredItems.slice(start, end).map(function (i) {
      var typeLabel = detectType(i);
      var typeCel = typeLabel
        ? '<span class="sot-type-tag">' + typeLabel + "</span>"
        : '<span class="sot-td-none">‚Äî</span>';
      return "<tr>" +
        '<td class="sot-td-date">' + fmtDate(i.pubDate) + "</td>" +
        '<td><span class="sot-src">' + escHTML(i._src) + "</span></td>" +
        "<td>" + typeCel + "</td>" +
        '<td><a class="sot-table-title" href="' + escAttr(i.link) +
        '" target="_blank" rel="noopener">' + escHTML(i.title) + "</a></td>" +
        "</tr>";
    }).join("");

    pagination.style.display = totalPages > 1 ? "flex" : "none";
    pageInfo.textContent = "Page " + currentPage + " / " + totalPages +
      "  ¬∑  " + (start + 1) + "‚Äì" + end + " of " + total;
    prevBtn.disabled = currentPage === 1;
    nextBtn.disabled = currentPage === totalPages;
  }

  function applyFilter() {
    filteredItems = allItems.filter(function (i) { return matchesCat(i, activeTab); });
    currentPage = 1;
    renderPage();
  }

  /* ‚îÄ‚îÄ refresh ‚îÄ‚îÄ */
  function refresh() {
    var btn = document.getElementById("sot-refresh-btn");
    var loading = document.getElementById("sot-loading");
    var list = document.getElementById("sot-list");
    var upd = document.getElementById("sot-updated");

    btn.disabled = true;
    btn.textContent = "‚ü≥";
    loading.style.display = "block";
    list.style.display = "none";
    feedLog = [];
    allItems = [];
    pendingFeeds = FEEDS.length;

    var collected = [];

    function onFeedDone(items) {
      collected = collected.concat(items);
      pendingFeeds--;
      if (pendingFeeds > 0) return;

      /* all feeds done */
      var cutoff = Date.now() - 30 * 24 * 60 * 60 * 1000;
      if (collected.length) {
        var recent = collected.filter(function (i) { return new Date(i.pubDate).getTime() > cutoff; });
        allItems = (recent.length ? recent : collected).sort(function (a, b) {
          return new Date(b.pubDate) - new Date(a.pubDate);
        });
      }

      loading.style.display = "none";
      list.style.display = "block";
      btn.disabled = false;
      btn.textContent = "‚ü≥ Refresh";

      var now = new Date();
      upd.textContent = (allItems.length ? allItems.length + " articles  ¬∑  " : "") +
        "Updated " + now.toLocaleTimeString("en-GB", { hour: "2-digit", minute: "2-digit" });

      applyFilter();
    }

    FEEDS.forEach(function (feed) {
      fetchFeed(feed, onFeedDone);
    });
  }

  /* ‚îÄ‚îÄ events ‚îÄ‚îÄ */
  document.getElementById("sot-refresh-btn").addEventListener("click", refresh);

  document.getElementById("sot-prev-btn").addEventListener("click", function () {
    if (currentPage > 1) { currentPage--; renderPage(); }
  });

  document.getElementById("sot-next-btn").addEventListener("click", function () {
    if (currentPage < Math.ceil(filteredItems.length / ITEMS_PER_PAGE)) {
      currentPage++; renderPage();
    }
  });

  document.querySelectorAll("#sot-tabs .sot-tab").forEach(function (tab) {
    tab.addEventListener("click", function () {
      document.querySelectorAll("#sot-tabs .sot-tab").forEach(function (t) { t.classList.remove("active"); });
      this.classList.add("active");
      activeTab = this.dataset.key;
      applyFilter();
    });
  });

  /* ‚îÄ‚îÄ init ‚îÄ‚îÄ */
  refresh();
})();
</script>
